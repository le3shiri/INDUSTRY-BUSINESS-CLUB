<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluxence - Negotiations</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/negotiations.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="js/components.js"></script>
</head>

<body>

    <div class="layout-dashboard">
        <aside id="sidebar-container"></aside>

        <main class="main-content">
            <header style="margin-bottom: 2rem;">
                <h1
                    style="font-size: 2.5rem; font-weight: 800; color: var(--text-primary); margin-bottom: 1.5rem; letter-spacing: -0.02em;">
                    Negotiations</h1>

                <div class="negotiation-tabs">
                    <div class="tab-pill active" onclick="switchTab('buying')" id="pill-buying">Buying (2)</div>
                    <div class="tab-pill" onclick="switchTab('selling')" id="pill-selling">Selling (1)</div>
                </div>
            </header>

            <!-- Buying List -->
            <div id="buying-list" class="fade-in-up">
                <!-- Items injected by JS -->
            </div>

            <!-- Selling List -->
            <div id="selling-list" class="fade-in-up" style="display: none;">
                <!-- Items injected by JS -->
            </div>


            <!-- Empty State -->
            <div id="negotiations-empty-state" class="empty-state" style="display: none;">
                <i class="fas fa-handshake-slash"></i>
                <h3>No active negotiations</h3>
                <p>You don't have any ongoing deals at the moment. Browse the marketplace to start a new negotiation.
                </p>
                <button class="btn btn-primary" style="width: auto;" onclick="window.location.href='search.html'">Browse
                    Marketplace</button>
            </div>
        </main>
    </div>

    <script src="js/app.js"></script>
    <script>
        // Mock Data
        const negotiations = [
            {
                id: 1,
                role: 'buyer',
                title: '50 Tons of Portland Cement',
                status: 'pending',
                lastOffer: 115000,
                listPrice: 120000,
                icon: 'fa-cube'
            },
            {
                id: 2,
                role: 'buyer',
                title: 'Copper Wiring Scraps (Lot)',
                status: 'accepted',
                lastOffer: 45000,
                listPrice: 45000,
                icon: 'fa-bolt'
            },
            {
                id: 3,
                role: 'seller',
                title: 'Aluminum Blocks',
                status: 'pending',
                lastOffer: 12500,
                listPrice: 13000,
                icon: 'fa-layer-group'
            }
        ];

        function renderList() {
            const buyList = document.getElementById('buying-list');
            const sellList = document.getElementById('selling-list');

            buyList.innerHTML = '';
            sellList.innerHTML = '';

            negotiations.forEach(neg => {
                const card = `
                <a href="negotiation-room.html?role=${neg.role}&id=${neg.id}" class="negotiation-card">
                    <div class="neg-thumb" style="border-right: 1px solid var(--border-color);"><i class="fas ${neg.icon} fa-2x" style="color: var(--primary-color);"></i></div>
                    <div class="neg-info">
                        <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text-primary); margin: 0 0 0.5rem 0;">${neg.title}</h3>
                        <div style="font-size: 0.95rem; color: var(--text-secondary); display: flex; gap: 1.5rem; font-weight: 500;">
                            <span>${neg.role === 'buyer' ? 'My Offer' : 'Received Offer'}: <strong style="color: var(--primary-color);">${neg.lastOffer.toLocaleString()} MAD</strong></span>
                            <span>Listing: ${neg.listPrice.toLocaleString()} MAD</span>
                        </div>
                    </div>
                    <span class="neg-status status-${neg.status}" style="font-weight: 700;">${neg.status}</span>
                    <i class="fas fa-chevron-right" style="color: var(--primary-color); margin-left: 1rem; font-size: 1.2rem;"></i>
                </a>
                      `;

                if (neg.role === 'buyer') buyList.innerHTML += card;
                else sellList.innerHTML += card;
            });
        }

        function switchTab(type) {
            document.querySelectorAll('.tab-pill').forEach(p => p.classList.remove('active'));
            document.getElementById('pill-' + type).classList.add('active');

            if (type === 'buying') {
                document.getElementById('buying-list').style.display = 'block';
                document.getElementById('selling-list').style.display = 'none';
            } else {
                document.getElementById('buying-list').style.display = 'none';
                document.getElementById('selling-list').style.display = 'block';
            }
        }

        // Init
        renderList();
    </script>
</body>

</html>