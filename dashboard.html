<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluxence - Dashboard</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="js/components.js"></script>
</head>

<body>

    <!-- Overlay -->
    <div class="overlay" id="dashboard-overlay"></div>

    <!-- Main Grid -->
    <div class="layout-dashboard">

        <!-- Sidebar Navigation -->
        <!-- Sidebar Navigation -->
        <aside id="sidebar-container"></aside>

        <!-- Main Content -->
        <main class="main-content">

            <!-- Top Navbar -->
            <header class="top-nav">
                <div class="search-bar">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="Search materials, products...">
                </div>

                <div class="nav-actions">
                    <button class="icon-btn" onclick="toggleFilterSidebar()">
                        <i class="fas fa-sliders-h"></i>
                    </button>
                    <button class="icon-btn" onclick="window.location.href='notifications.html'">
                        <i class="fas fa-bell"></i>
                        <span class="badge">2</span>
                    </button>
                    <div class="profile-nav-item"
                        style="display: flex; align-items: center; gap: 0.75rem; margin-left: 0.5rem; cursor: pointer;"
                        onclick="window.location.href='profile-settings.html'">
                        <img src="assets/profiles/admin.png" alt="Admin"
                            style="width: 35px; height: 35px; border-radius: 50%; object-fit: cover; border: 2px solid var(--primary-color);">
                    </div>
                    <button class="btn btn-primary" style="width: auto; padding: 0.6rem 1.25rem; font-size: 0.9rem;"
                        onclick="openKYCModal()">
                        <i class="fas fa-check-circle" style="margin-right: 0.5rem;"></i> Verify Account
                    </button>
                </div>
            </header>

            <!-- Welcome Section -->
            <section style="margin-bottom: 2.5rem; display: flex; align-items: center; gap: 2rem;">
                <div
                    style="width: 80px; height: 80px; min-width: 80px; border-radius: var(--radius-lg); background: var(--white); overflow: hidden; box-shadow: var(--shadow-md); border: 1px solid var(--border-color);">
                    <img src="assets/logos/acme_corp.png" alt="Acme Corp"
                        style="width: 100%; height: 100%; object-fit: cover;">
                </div>
                <div>
                    <h1
                        style="font-size: 2.5rem; font-weight: 800; color: var(--text-primary); margin-bottom: 0.25rem; letter-spacing: -0.02em;">
                        Welcome back, Acme Corp!</h1>
                    <p class="text-secondary" style="font-size: 1.1rem; font-weight: 500;">Based on your interests in
                        <strong style="color: var(--primary-color);">Construction</strong> & <strong
                            style="color: var(--pure-black);">Logistics</strong>, we found <strong>2 new
                            matches</strong>
                        for you on Fluxence.
                    </p>
                </div>
            </section>

            <!-- Categories Chips -->
            <div class="chips-row">
                <div class="chip active">All</div>
                <div class="chip">Raw Materials</div>
                <div class="chip">Machinery</div>
                <div class="chip">Logistics</div>
                <div class="chip">Scrap Metal</div>
                <div class="chip">Electrical</div>
                <div class="chip">Chemicals</div>
                <div class="chip">Textile Waste</div>
            </div>

            <!-- Trending Materials Grid -->
            <div class="materials-grid">

                <!-- Card 1 -->
                <article class="material-card">
                    <div class="condition-badge"
                        style="background: var(--white); color: var(--text-primary); border: 1px solid var(--border-color);">
                        Very Good</div>
                    <div class="card-img-container">
                        <img src="assets/products/rebar.png" alt="Steel Rebar"
                            style="width: 100%; height: 100%; object-fit: cover; border-bottom: 1px solid var(--border-color);">
                    </div>
                    <div class="card-body">
                        <div class="rating">
                            <i class="fas fa-star"></i> <span>4.8</span>
                        </div>
                        <h3 class="card-title">Steel Reinforcement Bars (Rebar)</h3>
                        <p class="card-desc">High-quality steel rebar available in bulk. Suitable for large construction
                            projects.</p>
                        <div class="card-meta">
                            <div>
                                <div class="price">$850 / ton</div>
                                <div class="qty">Min: 10 tons</div>
                            </div>
                            <button class="btn btn-primary" style="width: auto; padding: 0.5rem 1.5rem;"
                                onclick="window.location.href='product-detail.html?id=1'">View Item</button>
                        </div>
                    </div>
                </article>

                <!-- Card 2 -->
                <article class="material-card">
                    <div class="condition-badge"
                        style="background: var(--primary-color); color: var(--white); border: 1px solid var(--pure-black);">
                        New</div>
                    <div class="card-img-container">
                        <img src="assets/products/forklift.png" alt="Heavy Duty Forklift"
                            style="width: 100%; height: 100%; object-fit: cover; border-bottom: 1px solid var(--border-color);">
                    </div>
                    <div class="card-body">
                        <div class="rating">
                            <i class="fas fa-star"></i> <span>5.0</span>
                        </div>
                        <h3 class="card-title">Heavy Duty Forklift - 5 Ton</h3>
                        <p class="card-desc">2024 Model, diesel engine, barely used. Perfect for warehouse logistics.
                        </p>
                        <div class="card-meta">
                            <div>
                                <div class="price">$22,000</div>
                                <div class="qty">1 Unit</div>
                            </div>
                            <button class="btn btn-primary" style="width: auto; padding: 0.5rem 1.5rem;"
                                onclick="window.location.href='product-detail.html?id=2'">View Item</button>
                        </div>
                    </div>
                </article>

                <!-- Card 3 -->
                <article class="material-card">
                    <div class="condition-badge"
                        style="background: var(--pure-black); color: var(--white); border: 1px solid var(--pure-black);">
                        Used</div>
                    <div class="card-img-container">
                        <img src="assets/products/copper_cables.png" alt="Copper Cabling"
                            style="width: 100%; height: 100%; object-fit: cover; border-bottom: 1px solid var(--border-color);">
                    </div>
                    <div class="card-body">
                        <div class="rating">
                            <i class="fas fa-star"></i> <span>4.5</span>
                        </div>
                        <h3 class="card-title">Copper Cabling Spools</h3>
                        <p class="card-desc">Remaining stock from industrial project. Approx 500m of insulated copper
                            wire.</p>
                        <div class="card-meta">
                            <div>
                                <div class="price">$4.20 / meter</div>
                                <div class="qty">Total: 500m</div>
                            </div>
                            <button class="btn btn-primary" style="width: auto; padding: 0.5rem 1.5rem;"
                                onclick="window.location.href='product-detail.html?id=3'">View Item</button>
                        </div>
                    </div>
                </article>

                <!-- Card 4 -->
                <article class="material-card">
                    <div class="condition-badge"
                        style="background: var(--white); color: var(--text-primary); border: 1px solid var(--border-color);">
                        Refurbished</div>
                    <div class="card-img-container">
                        <img src="assets/products/conveyor.png" alt="Industrial Conveyor"
                            style="width: 100%; height: 100%; object-fit: cover; border-bottom: 1px solid var(--border-color);">
                    </div>
                    <div class="card-body">
                        <div class="rating">
                            <i class="fas fa-star"></i> <span>4.9</span>
                        </div>
                        <h3 class="card-title">Industrial Conveyor Belt System</h3>
                        <p class="card-desc">Modular conveyor unit, fully serviced. Speed adjustable.</p>
                        <div class="card-meta">
                            <div>
                                <div class="price">$5,500</div>
                                <div class="qty">1 Set</div>
                            </div>
                            <button class="btn btn-primary" style="width: auto; padding: 0.5rem 1.5rem;"
                                onclick="window.location.href='product-detail.html?id=4'">View Item</button>
                        </div>
                    </div>
                </article>

            </div>
        </main>
    </div>

    <!-- Partials Injection -->
    <!-- KYC Modal (Inlined) -->
    <div id="kyc-modal" class="modal-centered">

        <div class="modal-header">
            <div>
                <h2 class="modal-title">
                    <i class="fas fa-shield-alt" style="color: var(--primary-color);"></i>
                    Verify Account
                </h2>
                <p class="modal-subtitle">Upload official documents to unlock full access.</p>
            </div>
            <button class="icon-btn" onclick="closeOverlay()"><i class="fas fa-times"></i></button>
        </div>

        <!-- Upload Area 1 -->
        <div class="modal-section">
            <h4 class="modal-section-title">Company Registration / ID</h4>
            <div class="upload-area-themed" onclick="document.getElementById('file-id').click()">
                <input type="file" id="file-id" hidden onchange="showFileName(this, 'file-name-1')">
                <i class="fas fa-cloud-upload-alt upload-icon"></i>
                <p style="font-size: 0.95rem; font-weight: 500; color: var(--text-primary); margin: 0;">Click to upload
                    or drag and drop</p>
                <p style="font-size: 0.8rem; color: var(--text-secondary); margin: 0;">PDF, JPG or PNG (max. 5MB)</p>
                <p id="file-name-1"
                    style="margin-top: 0.5rem; font-weight: 700; color: var(--primary-color); display: none;"></p>
            </div>
        </div>

        <!-- Upload Area 2 -->
        <div class="modal-section">
            <h4 class="modal-section-title">Bank Statement (RIB)</h4>
            <div class="upload-area-themed" onclick="document.getElementById('file-rib').click()">
                <input type="file" id="file-rib" hidden onchange="showFileName(this, 'file-name-2')">
                <i class="fas fa-file-invoice-dollar upload-icon" style="opacity: 1;"></i>
                <p style="font-size: 0.95rem; font-weight: 500; color: var(--text-primary); margin: 0;">Click to upload
                    RIB document</p>
                <p id="file-name-2"
                    style="margin-top: 0.5rem; font-weight: 700; color: var(--primary-color); display: none;"></p>
            </div>
        </div>

        <!-- Action -->
        <div class="modal-actions">
            <button class="btn btn-secondary" style="width: auto;" onclick="closeOverlay()">Cancel</button>
            <button class="btn btn-primary" style="width: auto;" onclick="submitKYC()">
                Submit Verification
            </button>
        </div>
    </div>
    <!-- Filter Sidebar (Inlined) -->
    <div id="filter-sidebar" class="sidebar-right">

        <div class="sidebar-header-pane">
            <h3 class="modal-title" style="font-size: 1.3rem;">
                <i class="fas fa-sliders-h" style="color: var(--primary-color);"></i> Filters
            </h3>
            <button class="icon-btn" onclick="closeOverlay()"><i class="fas fa-times"></i></button>
        </div>

        <!-- Category -->
        <div class="filter-group">
            <label class="filter-label">Category</label>
            <div class="pills-grid">
                <div class="pill-option active" style="font-size: 0.8rem; padding: 0.5rem 1rem;">All</div>
                <div class="pill-option" style="font-size: 0.8rem; padding: 0.5rem 1rem;">Metals</div>
                <div class="pill-option" style="font-size: 0.8rem; padding: 0.5rem 1rem;">Plastics</div>
                <div class="pill-option" style="font-size: 0.8rem; padding: 0.5rem 1rem;">Machinery</div>
                <div class="pill-option" style="font-size: 0.8rem; padding: 0.5rem 1rem;">Electronics</div>
            </div>
        </div>

        <!-- Price Range -->
        <div class="filter-group">
            <label class="filter-label">Price Range</label>
            <div style="display: flex; gap: 1rem; align-items: center;">
                <div style="flex: 1;">
                    <label
                        style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem; display: block;">Min</label>
                    <input type="number" class="form-input" placeholder="0" style="padding: 0.6rem;">
                </div>
                <span style="color: var(--text-secondary); margin-top: 1rem;">-</span>
                <div style="flex: 1;">
                    <label
                        style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem; display: block;">Max</label>
                    <input type="number" class="form-input" placeholder="Any" style="padding: 0.6rem;">
                </div>
            </div>
        </div>

        <!-- Radius Slider -->
        <div class="filter-group">
            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                <label class="filter-label">Search Radius</label>
                <span style="font-size: 0.9rem; font-weight: 700; color: var(--primary-color);" id="radius-val">50
                    km</span>
            </div>
            <div class="range-slider-container">
                <input type="range" min="0" max="100" value="50" class="range-slider" id="radius-slider"
                    oninput="document.getElementById('radius-val').innerText = this.value + ' km'">
            </div>
        </div>

        <!-- Condition -->
        <div class="filter-group">
            <label class="filter-label">Condition</label>
            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <label class="checkbox-themed">
                    <input type="checkbox" checked> New / Unused
                </label>
                <label class="checkbox-themed">
                    <input type="checkbox"> Used - Good
                </label>
                <label class="checkbox-themed">
                    <input type="checkbox"> Refurbished
                </label>
            </div>
        </div>

        <!-- Actions -->
        <div style="margin-top: auto; display: flex; gap: 1rem;">
            <button class="btn btn-secondary" onclick="closeOverlay()">Clear</button>
            <button class="btn btn-primary" onclick="closeOverlay()">Show Results</button>
        </div>
    </div>
    <div id="notification-area" class="notification-container"></div>

    <script src="js/app.js"></script>
    <script>
        // Quick Script (Simulating Framework Behavior)
        document.addEventListener('DOMContentLoaded', () => {
            // Components inlined for stability

            // Simulated Notification after 1.5s
            setTimeout(() => {
                showToast("New Deal Alert", "Atlas Cement just posted '50 tons of Portland Cement'.");
            }, 1500);
        });

        // --- UI Logic ---

        function openKYCModal() {
            const kyc = document.getElementById('kyc-modal');
            if (kyc) {
                document.getElementById('dashboard-overlay').classList.add('active');
                kyc.style.opacity = '1';
                kyc.style.pointerEvents = 'auto';
                kyc.style.transform = 'translate(-50%, -50%)';
            } else {
                console.error("KYC Modal not loaded yet");
            }
        }

        function closeOverlay() {
            document.getElementById('dashboard-overlay').classList.remove('active');

            // Close KYC
            const kyc = document.getElementById('kyc-modal');
            if (kyc) {
                kyc.style.opacity = '0';
                kyc.style.pointerEvents = 'none';
                kyc.style.transform = 'translate(-50%, -40%)';
            }

            // Close Filter
            const filter = document.getElementById('filter-sidebar');
            if (filter) {
                filter.style.right = '-400px';
            }
        }

        function toggleFilterSidebar() {
            const sidebar = document.getElementById('filter-sidebar');
            if (sidebar) {
                document.getElementById('dashboard-overlay').classList.add('active');
                sidebar.style.right = '0';
            } else {
                console.error("Filter sidebar not loaded yet");
            }
        }

        // --- Notifications Logic ---
        function showToast(title, message) {
            const container = document.getElementById('notification-area');

            // Ensure container exists
            if (!container) return;

            // Create Toast Element
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `
            <div class="toast-icon">
                <i class="fas fa-bell"></i>
            </div>
            <div class="toast-content">
                <div class="toast-title">${title}</div>
                <div class="toast-msg">${message}</div>
            </div>
            <div class="toast-close" onclick="this.parentElement.classList.add('hiding'); setTimeout(() => this.parentElement.remove(), 400);">
                <i class="fas fa-times"></i>
            </div>
        `;

            container.appendChild(toast);

            // Auto hide after 6 seconds (optional, user asked for 'till click X', but auto-hide is good UX. 
            // I will stick to user request: "till user clicks on X" implies no auto-hide, or long auto-hide. 
            // Removing auto-hide timeout based on request.)
        }

        document.getElementById('dashboard-overlay').addEventListener('click', closeOverlay);
    </script>
</body>

</html>